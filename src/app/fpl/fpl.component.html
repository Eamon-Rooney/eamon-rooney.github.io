<header>
  <h1>FPL</h1>
</header>

<section>
  <section>
    <p class="error" *ngIf="standingsErrors?.status === 403">
      Using
      <a href="https://cors-anywhere.herokuapp.com">
        CORS ANYWHERE
      </a>
      proxy that requires requesting temp access daily
    </p>

    <p class="error" *ngIf="standingsErrors?.status === 429">
      You are making too many requests
    </p>

    <p class="error" *ngIf="standingsErrors?.status === 503">
      The game is being updated, try again later
    </p>
  </section>
</section>

<section>
  <button [(ngModel)]="toogleDGWs" class="button button-primary" (click)="toggleDoubleGws()"> {{ toogleDGWs }} double game weeks</button>

  <ng-container *ngIf="toogleDGWs == 'Hide'">
    <h2>Double Gameweek: {{ fixtureDGW - gameweekID }} game weeks time</h2>
    <Label>Switch Gameweek: </Label>
    <select [(ngModel)]="fixtureDGW" (ngModelChange)="updateDoubleGameweek()">
      <option *ngFor="let DGWEvent of doubleGameweekEventID; let i = index" [ngValue]="DGWEvent.id"> {{ DGWEvent.id }} </option>
    </select>
    <Label> Current Gameweek: {{ gameweekID }}</Label>

      <ul>
        <ng-container *ngFor="let team of teams">
          <ng-container *ngFor="let doubleGameWeekLine of doubleGameWeekMap; let i = index">
            <li *ngIf="doubleGameWeekLine.dgwTeam === team?.id">
              <app-card>
                <h4>{{ team?.name }}</h4>
                <ng-container *ngFor="let team of teams">
                  <ng-container *ngFor="let vsTeam of doubleGameWeekLine.vsTeams">
                    <ng-container *ngIf="vsTeam === team?.id">
                      <p>vs {{ team?.name }}</p>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </app-card>
            </li>
          </ng-container>
        </ng-container>
      </ul>
    </ng-container>
  </section>

<section>
  <form [formGroup]="leagueForm" *ngIf="this.leagueForm">
    <label>Switch League: </label>
    <input [(ngModel)]="league.league.id"
    (ngModelChange)="updateLeague()"
    class="form-control"
    formControlName="leagueID"/>
    <p class="error" *ngIf="leagueForm.controls['leagueID'].hasError('pattern') && (leagueForm.controls['leagueID'].dirty || leagueForm.controls['leagueID'].touched)">Use only numbers in League ID search</p>
  </form>
</section>

<section>
  <h2>League Name: {{ league.league.name }}</h2>

  <table>
    <thead>
      <tr>
        <app-card>
          <th>#</th>
          <th>Team Name</th>
          <th>Event Total</th>
          <th>Total</th>
        </app-card>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of standings | paginate: { itemsPerPage: 10, currentPage: p }" (click)="navigateToTeam(user)">
        <app-card>
          <td>{{ user?.rank }}</td>
          <td>{{ user?.entry_name }}</td>
          <td>{{ user?.event_total }}</td>
          <td>{{ user?.total }}</td>
        </app-card>
      </tr>
    </tbody>
  </table>

  <pagination-controls (pageChange)="p = $event"></pagination-controls>
</section>

<router-outlet (activate)="onOutletLoaded($event)"></router-outlet>
